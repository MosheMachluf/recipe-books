(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0fbdec68"],{"04bb":function(e,t,o){"use strict";o.r(t);var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("v-card",{staticClass:"mx-auto",attrs:{disabled:e.isLoading,loading:e.isLoading,"max-width":"700",outlined:"",rounded:"lg"}},[o("v-card-title",[e._v("ערוך ספר - "+e._s(e.book.title))]),o("v-card-text",[o("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[o("v-text-field",{attrs:{filled:"",label:"כותרת",required:"",clearable:""},model:{value:e.book.title,callback:function(t){e.$set(e.book,"title",t)},expression:"book.title"}}),o("v-textarea",{attrs:{filled:"",label:"תיאור",clearable:""},model:{value:e.book.description,callback:function(t){e.$set(e.book,"description",t)},expression:"book.description"}}),o("v-text-field",{attrs:{filled:"",label:"תמונה",required:"",clearable:""},model:{value:e.book.image,callback:function(t){e.$set(e.book,"image",t)},expression:"book.image"}}),o("v-img",{directives:[{name:"show",rawName:"v-show",value:e.previewImageLoaded,expression:"previewImageLoaded"}],staticClass:"mx-auto mb-5",attrs:{src:e.book.image,"max-width":"70%"},on:{load:e.onImgLoad}}),e.error?o("v-alert",{attrs:{dense:"",text:"",type:"error"}},[e._v(" "+e._s(e.error)+" ")]):e._e(),o("div",{staticClass:"text-center"},[o("v-btn",{attrs:{color:"success","min-width":"170px","min-height":"50px",large:"",depressed:"",loading:e.isLoading,disabled:!e.valid},on:{click:e.submitForm}},[o("span",{staticClass:"font-weight-bold",staticStyle:{"font-size":"16px"}},[e._v("שמור")])])],1)],1)],1)],1)},r=[],i=o("5530"),n=o("1da1"),s=(o("96cf"),o("d3b7"),o("b64b"),o("ac1f"),o("5319"),o("a4d3"),o("e01a"),{data:function(){return{isLoading:!1,error:null,valid:!0,book:{title:null,description:null,image:null},previewImageLoaded:!1,formSubmitted:!1}},computed:{formChanged:function(){var e=this,t=this.$store.getters["books/currentBook"];return Object.keys(this.book).some((function(o){return e.book[o]!==t[o]}))},bookId:function(){return this.$route.params.bookId}},watch:{image:function(e){this.previewImageLoaded=!1,(null===e||void 0===e?void 0:e.length)>10?this.error="תמונה לא תקינה":this.error=""}},beforeRouteLeave:function(e,t,o){if(!this.formChanged||this.formSubmitted)o();else{var a=confirm("בטוח שברצונך לעזוב? שינויים לא נשמרו");o(a)}},created:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var o,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return o=localStorage.getItem("userId"),t.next=3,e.$store.dispatch("books/fetchBook",{bookId:e.bookId});case 3:if(a=e.$store.getters["books/currentBook"],o===a.userId._id){t.next=8;break}return t.next=7,e.$router.replace({name:"Book",params:{bookId:e.bookId}});case 7:return t.abrupt("return");case 8:a&&(e.book.title=a.title,e.book.description=a.description,e.book.image=a.image);case 9:case"end":return t.stop()}}),t)})))()},methods:{onImgLoad:function(){this.previewImageLoaded=!0,this.error=""},submitForm:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.formSubmitted=!0,e.$refs.form.validate()){t.next=3;break}return t.abrupt("return");case 3:return e.isLoading=!0,t.prev=4,t.next=7,e.$store.dispatch("books/updateBook",Object(i["a"])(Object(i["a"])({},e.book),{},{bookId:e.bookId}));case 7:return t.next=9,e.$router.replace({name:"Book",params:{bookId:e.bookId}});case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](4),e.error=t.t0.message;case 14:e.isLoading=!1;case 15:case"end":return t.stop()}}),t,null,[[4,11]])})))()}}}),u=s,c=o("2877"),l=o("6544"),d=o.n(l),h=o("0798"),b=o("8336"),m=o("b0af"),p=o("99d9"),f=o("4bd4"),g=o("adda"),v=o("8654"),k=o("a844"),w=Object(c["a"])(u,a,r,!1,null,null,null);t["default"]=w.exports;d()(w,{VAlert:h["a"],VBtn:b["a"],VCard:m["a"],VCardText:p["c"],VCardTitle:p["d"],VForm:f["a"],VImg:g["a"],VTextField:v["a"],VTextarea:k["a"]})},1681:function(e,t,o){},a844:function(e,t,o){"use strict";var a=o("5530"),r=(o("a9e3"),o("1681"),o("8654")),i=o("58df"),n=Object(i["a"])(r["a"]);t["a"]=n.extend({name:"v-textarea",props:{autoGrow:Boolean,noResize:Boolean,rowHeight:{type:[Number,String],default:24,validator:function(e){return!isNaN(parseFloat(e))}},rows:{type:[Number,String],default:5,validator:function(e){return!isNaN(parseInt(e,10))}}},computed:{classes:function(){return Object(a["a"])({"v-textarea":!0,"v-textarea--auto-grow":this.autoGrow,"v-textarea--no-resize":this.noResizeHandle},r["a"].options.computed.classes.call(this))},noResizeHandle:function(){return this.noResize||this.autoGrow}},watch:{autoGrow:function(e){var t=this;this.$nextTick((function(){var o;e?t.calculateInputHeight():null==(o=t.$refs.input)||o.style.removeProperty("height")}))},lazyValue:function(){this.autoGrow&&this.$nextTick(this.calculateInputHeight)},rowHeight:function(){this.autoGrow&&this.$nextTick(this.calculateInputHeight)}},mounted:function(){var e=this;setTimeout((function(){e.autoGrow&&e.calculateInputHeight()}),0)},methods:{calculateInputHeight:function(){var e=this.$refs.input;if(e){e.style.height="0";var t=e.scrollHeight,o=parseInt(this.rows,10)*parseFloat(this.rowHeight);e.style.height=Math.max(o,t)+"px"}},genInput:function(){var e=r["a"].options.methods.genInput.call(this);return e.tag="textarea",delete e.data.attrs.type,e.data.attrs.rows=this.rows,e},onInput:function(e){r["a"].options.methods.onInput.call(this,e),this.autoGrow&&this.calculateInputHeight()},onKeyDown:function(e){this.isFocused&&13===e.keyCode&&e.stopPropagation(),this.$emit("keydown",e)}}})}}]);
//# sourceMappingURL=chunk-0fbdec68.dc41387a.js.map